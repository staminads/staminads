!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Staminads=t()}(this,function(){"use strict";const e="stm_";class t{constructor(){this.useMemory=!1,this.memory=new Map,this.testStorage()}testStorage(){try{const t=e+"test";localStorage.setItem(t,"test"),localStorage.removeItem(t)}catch{this.useMemory=!0}}get(t){const i=e+t;if(this.useMemory){const e=this.memory.get(i);if(void 0===e)return null;try{return JSON.parse(e)}catch{return null}}try{const e=localStorage.getItem(i);return null===e?null:JSON.parse(e)}catch{return this.useMemory=!0,this.memory.get(i)?JSON.parse(this.memory.get(i)):null}}set(t,i){const s=e+t,n=JSON.stringify(i);if(this.useMemory)this.memory.set(s,n);else try{localStorage.setItem(s,n)}catch{this.useMemory=!0,this.memory.set(s,n)}}remove(t){const i=e+t;if(this.useMemory)this.memory.delete(i);else try{localStorage.removeItem(i)}catch{this.memory.delete(i)}}clear(){if(this.useMemory)this.memory.clear();else try{const t=[];for(let i=0;i<localStorage.length;i++){const s=localStorage.key(i);s?.startsWith(e)&&t.push(s)}t.forEach(e=>localStorage.removeItem(e))}catch{this.memory.clear()}}isUsingMemory(){return this.useMemory}}class i{constructor(){this.memory=new Map,this.useMemory=!1,this.testStorage()}testStorage(){try{const t=e+"test";sessionStorage.setItem(t,"test"),sessionStorage.removeItem(t)}catch{this.useMemory=!0}}get(t){const i=e+t;if(this.useMemory){const e=this.memory.get(i);if(void 0===e)return null;try{return JSON.parse(e)}catch{return null}}try{const e=sessionStorage.getItem(i);return null===e?null:JSON.parse(e)}catch{return this.useMemory=!0,null}}set(t,i){const s=e+t,n=JSON.stringify(i);if(this.useMemory)this.memory.set(s,n);else try{sessionStorage.setItem(s,n)}catch{this.useMemory=!0,this.memory.set(s,n)}}}const s="session",n="visitor_id",a="pending",r="tab_id",o="dimensions";function h(){if(crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Array.from(e,e=>e.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}function c(){const e=Date.now().toString(16).padStart(12,"0"),t=new Uint8Array(10);crypto.getRandomValues(t);const i=Array.from(t,e=>e.toString(16).padStart(2,"0")).join("");return[e.slice(0,8),e.slice(8,12),"7"+i.slice(0,3),(3&parseInt(i.slice(3,4),16)|8).toString(16)+i.slice(4,7),i.slice(7,19)].join("-")}const l=["gclid","fbclid","msclkid","dclid","twclid","ttclid","li_fat_id","wbraid","gbraid"];class u{constructor(e,t,i){this.session=null,this.storage=e,this.tabStorage=t,this.config=i,this.debug=i.debug,this.tabId=this.getOrCreateTabId()}getOrCreateSession(){const e=this.storage.get(s);return e&&!this.isSessionExpired(e)?(e.last_active_at=Date.now(),e.updated_at=Date.now(),e.sequence++,this.session=e,this.saveSession(),this.storage.get(n)||this.storage.set(n,e.visitor_id),this.debug,e):this.createSession()}createSession(){const e=Date.now(),t=function(e,t=l){const i=new URL(e).searchParams;let s=null,n=null;for(const e of t){const t=i.get(e);if(t){s=t,n=e;break}}return{source:i.get("utm_source"),medium:i.get("utm_medium"),campaign:i.get("utm_campaign"),term:i.get("utm_term"),content:i.get("utm_content"),id:s,id_from:n}}(window.location.href,this.config.adClickIds);let i=this.storage.get(n);i||(i=h(),this.storage.set(n,i));const s={id:c(),visitor_id:i,workspace_id:this.config.workspace_id,created_at:e,updated_at:e,last_active_at:e,focus_duration_ms:0,total_duration_ms:0,referrer:document.referrer||null,landing_page:window.location.href,utm:this.hasUTMValues(t)?t:null,max_scroll_percent:0,interaction_count:0,sdk_version:"5.0.0",sequence:0,dimensions:this.loadDimensions()};return this.session=s,this.saveSession(),this.debug,s}isSessionExpired(e){return Date.now()-e.last_active_at>this.config.sessionTimeout}hasUTMValues(e){return Boolean(e.source||e.medium||e.campaign||e.term||e.content||e.id)}getSession(){return this.session}updateSession(e){this.session&&(Object.assign(this.session,e,{updated_at:Date.now(),last_active_at:Date.now()}),this.saveSession())}saveSession(){this.session&&this.storage.set(s,this.session)}getTabId(){return this.tabId}getOrCreateTabId(){let e=this.tabStorage.get(r);return e||(e=h(),this.tabStorage.set(r,e)),e}getVisitorId(){return this.session?.visitor_id||""}getSessionId(){return this.session?.id||""}setDimension(e,t){if(e<1||e>10)throw new Error("Dimension index must be between 1 and 10");if("string"!=typeof t)throw new Error("Dimension value must be a string");if(t.length>256)throw new Error("Dimension value must be 256 characters or less");this.session&&(this.session.dimensions[e]=t,this.saveDimensions(),this.saveSession(),this.debug)}setDimensions(e){for(const[t,i]of Object.entries(e))this.setDimension(Number(t),i)}getDimension(e){return this.session&&this.session.dimensions[e]||null}clearDimensions(){this.session&&(this.session.dimensions={},this.saveDimensions(),this.saveSession())}getDimensionsPayload(){if(!this.session)return{};const e={};for(const[t,i]of Object.entries(this.session.dimensions))e[`stm_${t}`]=i;return e}loadDimensions(){return this.storage.get(o)||{}}saveDimensions(){this.session&&this.storage.set(o,this.session.dimensions)}reset(){return this.storage.remove(s),this.storage.remove(o),this.session=null,this.createSession()}}const d="stm_session_state";class g{constructor(e){this.actions=[],this.currentPage=null,this.checkpoint=-1,this.attributesSent=!1,this.workspaceId=e.workspace_id,this.sessionId=e.session_id,this.createdAt=e.created_at}getActions(){return[...this.actions]}getCurrentPage(){return this.currentPage?{...this.currentPage}:null}getCheckpoint(){return this.checkpoint}hasAttributesSent(){return this.attributesSent}addPageview(e){const t=Date.now();this.currentPage&&this.finalizeCurrentPage(t);const i=this.getNextPageNumber();this.currentPage={path:e,page_number:i,entered_at:t,scroll:0}}updateScroll(e){if(!this.currentPage)return;const t=Math.max(0,Math.min(100,e));t>this.currentPage.scroll&&(this.currentPage.scroll=t)}addGoal(e,t,i){if(this.actions.length>=1e3)return!1;const s={type:"goal",name:e,path:this.currentPage?.path||"/",page_number:this.currentPage?.page_number||1,timestamp:Date.now()};return void 0!==t&&(s.value=t),i&&(s.properties=i),this.actions.push(s),this.actions.length,!0}buildPayload(e){const t={workspace_id:this.workspaceId,session_id:this.sessionId,actions:[...this.actions],created_at:this.createdAt,updated_at:Date.now(),sdk_version:"6.0.0"};return this.currentPage&&(t.current_page={...this.currentPage}),this.checkpoint>=0&&(t.checkpoint=this.checkpoint),this.attributesSent||(t.attributes=e),t}applyCheckpoint(e){e>this.checkpoint&&(this.checkpoint=e)}markAttributesSent(){this.attributesSent=!0}finalizeForUnload(){this.currentPage&&(this.finalizeCurrentPage(Date.now()),this.currentPage=null)}persist(){try{const e={actions:this.actions,currentPage:this.currentPage,checkpoint:this.checkpoint,attributesSent:this.attributesSent},t={session_id:this.sessionId,...e};sessionStorage.setItem(d,JSON.stringify(t))}catch(e){}}restore(){try{const e=sessionStorage.getItem(d);if(!e)return;const t=JSON.parse(e);if(t.session_id!==this.sessionId)return void sessionStorage.removeItem(d);this.actions=t.actions||[],this.currentPage=t.currentPage||null,this.checkpoint=t.checkpoint??-1,this.attributesSent=t.attributesSent??!1}catch(e){sessionStorage.removeItem(d)}}finalizeCurrentPage(e){if(!this.currentPage)return;const t=e-this.currentPage.entered_at,i={type:"pageview",path:this.currentPage.path,page_number:this.currentPage.page_number,duration:t,scroll:this.currentPage.scroll,entered_at:this.currentPage.entered_at,exited_at:e};this.actions.push(i)}getNextPageNumber(){let e=0;for(const t of this.actions)t.page_number>e&&(e=t.page_number);return this.currentPage&&this.currentPage.page_number>e&&(e=this.currentPage.page_number),e+1}}class w{constructor(e,t,i=!1){this.isFlushing=!1,this.endpoint=e,this.storage=t,this.debug=i,"undefined"!=typeof window&&window.addEventListener("online",()=>this.handleOnline())}stringifyWithSentAt(e){return JSON.stringify({...e,sent_at:Date.now()})}isOffline(){return"undefined"!=typeof navigator&&!1===navigator.onLine}getQueue(){return this.storage.get(a)||[]}saveQueue(e){const t=e.slice(-100);this.storage.set(a,t)}enqueue(e){const t=this.getQueue();t.push({payload:e,queuedAt:Date.now()}),this.saveQueue(t),this.debug}async handleOnline(){if(!this.isFlushing){this.isFlushing=!0,this.debug;try{const e=this.getQueue();if(0===e.length)return;this.storage.set(a,[]);const t=Date.now(),i=[];let s=0;for(const n of e){if(t-n.queuedAt>864e5){s++;continue}(await this.sendSessionDirect(n.payload)).success||i.push(n)}if(s>0&&this.debug,i.length>0){const e=this.getQueue();this.saveQueue([...i,...e])}}finally{this.isFlushing=!1}}}async sendSessionDirect(e){const t=`${this.endpoint}/api/track`;try{const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:this.stringifyWithSentAt(e),keepalive:!0});if(!i.ok)return{success:!1,error:`HTTP ${i.status}: ${i.statusText}`};return{success:!0,checkpoint:(await i.json()).checkpoint}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async sendSession(e){if(this.isOffline())return this.enqueue(e),{success:!1,error:"offline",queued:!0};const t=`${this.endpoint}/api/track`,i=new AbortController,s=setTimeout(()=>i.abort(),1e4);this.debug;try{const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:this.stringifyWithSentAt(e),keepalive:!0,signal:i.signal});if(clearTimeout(s),!n.ok)return{success:!1,error:`HTTP ${n.status}: ${n.statusText}`};const a=await n.json();return this.debug,{success:!0,checkpoint:a.checkpoint}}catch(t){return clearTimeout(s),this.debug,t instanceof Error&&"AbortError"===t.name?(this.enqueue(e),{success:!1,error:"Request timeout",queued:!0}):{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}sendSessionBeacon(e){if(this.isOffline())return this.enqueue(e),!1;const t=`${this.endpoint}/api/track`;if(this.debug,"function"==typeof fetchLater)try{return fetchLater(t,{method:"POST",headers:{"Content-Type":"application/json"},body:this.stringifyWithSentAt(e),activateAfter:0}),this.debug,!0}catch{}const i=this.stringifyWithSentAt(e);if(i.length<=15360&&navigator.sendBeacon)try{const e=new Blob([i],{type:"application/json"});if(navigator.sendBeacon(t,e))return this.debug,!0}catch{}try{return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:this.stringifyWithSentAt(e),keepalive:!0}),this.debug,!0}catch{return!1}}}var b,m="user-agent",p="",f="function",v="object",S="string",y="undefined",k="browser",x="cpu",_="device",T="engine",P="os",D="result",I="name",M="type",C="vendor",A="version",H="architecture",O="major",z="model",E="console",N="mobile",q="tablet",U="smarttv",R="wearable",L="xr",V="embedded",j="inapp",B="brands",F="formFactors",W="fullVersionList",$="platform",G="platformVersion",J="bitness",Q="sec-ch-ua",X=Q+"-full-version-list",Y=Q+"-arch",Z=Q+"-"+J,K=Q+"-form-factors",ee=Q+"-"+N,te=Q+"-"+z,ie=Q+"-"+$,se=ie+"-version",ne=[B,W,N,z,$,G,H,F,J],ae="Amazon",re="Apple",oe="ASUS",he="BlackBerry",ce="Google",le="Huawei",ue="Lenovo",de="Honor",ge="LG",we="Microsoft",be="Motorola",me="Nvidia",pe="OnePlus",fe="OPPO",ve="Samsung",Se="Sharp",ye="Sony",ke="Xiaomi",xe="Zebra",_e="Chrome",Te="Chromium",Pe="Chromecast",De="Edge",Ie="Firefox",Me="Opera",Ce="Facebook",Ae="Sogou",He="Mobile ",Oe=" Browser",ze="Windows",Ee=typeof window!==y&&window.navigator?window.navigator:void 0,Ne=Ee&&Ee.userAgentData?Ee.userAgentData:void 0,qe=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},Ue=function(e,t){if(typeof e===v&&e.length>0){for(var i in e)if(je(t)==je(e[i]))return!0;return!1}return!!Le(e)&&je(t)==je(e)},Re=function(e,t){for(var i in e)return/^(browser|cpu|device|engine|os)$/.test(i)||!!t&&Re(e[i])},Le=function(e){return typeof e===S},Ve=function(e){if(e){for(var t=[],i=We(/\\?\"/g,e).split(","),s=0;s<i.length;s++)if(i[s].indexOf(";")>-1){var n=Ge(i[s]).split(";v=");t[s]={brand:n[0],version:n[1]}}else t[s]=Ge(i[s]);return t}},je=function(e){return Le(e)?e.toLowerCase():e},Be=function(e){return Le(e)?We(/[^\d\.]/g,e).split(".")[0]:void 0},Fe=function(e){for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];typeof i==v&&2==i.length?this[i[0]]=i[1]:this[i]=void 0}return this},We=function(e,t){return Le(t)?t.replace(e,p):t},$e=function(e){return We(/\\?\"/g,e)},Ge=function(e,t){return e=We(/^\s\s*/,String(e)),typeof t===y?e:e.substring(0,t)},Je=function(e,t){if(e&&t)for(var i,s,n,a,r,o,h=0;h<t.length&&!r;){var c=t[h],l=t[h+1];for(i=s=0;i<c.length&&!r&&c[i];)if(r=c[i++].exec(e))for(n=0;n<l.length;n++)o=r[++s],typeof(a=l[n])===v&&a.length>0?2===a.length?typeof a[1]==f?this[a[0]]=a[1].call(this,o):this[a[0]]=a[1]:a.length>=3&&(typeof a[1]!==f||a[1].exec&&a[1].test?3==a.length?this[a[0]]=o?o.replace(a[1],a[2]):void 0:4==a.length?this[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):void 0:a.length>4&&(this[a[0]]=o?a[3].apply(this,[o.replace(a[1],a[2])].concat(a.slice(4))):void 0):a.length>3?this[a[0]]=o?a[1].apply(this,a.slice(2)):void 0:this[a[0]]=o?a[1].call(this,o,a[2]):void 0):this[a]=o||void 0;h+=2}},Qe=function(e,t){for(var i in t)if(typeof t[i]===v&&t[i].length>0){for(var s=0;s<t[i].length;s++)if(Ue(t[i][s],e))return"?"===i?void 0:i}else if(Ue(t[i],e))return"?"===i?void 0:i;return t.hasOwnProperty("*")?t["*"]:e},Xe={ME:"4.90","NT 3.51":"3.51","NT 4.0":"4.0",2e3:["5.0","5.01"],XP:["5.1","5.2"],Vista:"6.0",7:"6.1",8:"6.2",8.1:"6.3",10:["6.4","10.0"],NT:""},Ye={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":void 0},Ze={Chrome:"Google Chrome",Edge:"Microsoft Edge","Edge WebView2":"Microsoft Edge WebView2","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"},Ke={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[A,[I,He+"Chrome"]],[/webview.+edge\/([\w\.]+)/i],[A,[I,De+" WebView"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[A,[I,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[I,A],[/opios[\/ ]+([\w\.]+)/i],[A,[I,Me+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[A,[I,Me+" GX"]],[/\bopr\/([\w\.]+)/i],[A,[I,Me]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[A,[I,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[A,[I,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(atlas|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:lg |qute)browser|palemoon)\/([-\w\.]+)/i,/(heytap|ovi|115|surf|qwant)browser\/([\d\.]+)/i,/(qwant)(?:ios|mobile)\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[I,A],[/quark(?:pc)?\/([-\w\.]+)/i],[A,[I,"Quark"]],[/\bddg\/([\w\.]+)/i],[A,[I,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[A,[I,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[A,[I,"WeChat"]],[/konqueror\/([\w\.]+)/i],[A,[I,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[A,[I,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[A,[I,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[A,[I,"Smart "+ue+Oe]],[/(avast|avg)\/([\w\.]+)/i],[[I,/(.+)/,"$1 Secure"+Oe],A],[/\bfocus\/([\w\.]+)/i],[A,[I,Ie+" Focus"]],[/\bopt\/([\w\.]+)/i],[A,[I,Me+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[A,[I,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[A,[I,"Dolphin"]],[/coast\/([\w\.]+)/i],[A,[I,Me+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[A,[I,"MIUI"+Oe]],[/fxios\/([\w\.-]+)/i],[A,[I,He+Ie]],[/\bqihoobrowser\/?([\w\.]*)/i],[A,[I,"360"]],[/\b(qq)\/([\w\.]+)/i],[[I,/(.+)/,"$1Browser"],A],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[I,/(.+)/,"$1"+Oe],A],[/samsungbrowser\/([\w\.]+)/i],[A,[I,ve+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[A,[I,Ae+" Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[I,Ae+" Mobile"],A],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[I,A],[/(lbbrowser|rekonq|steam(?= (clie|tenf|gameo)))/i],[I],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[A,I],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[I,Ce],A,[M,j]],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(bing)(?:web|sapphire)\/([\w\.]+)/i,/(instagram|snapchat|klarna)[\/ ]([-\w\.]+)/i],[I,A,[M,j]],[/\bgsa\/([\w\.]+) .*safari\//i],[A,[I,"GSA"],[M,j]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[A,[I,"TikTok"],[M,j]],[/\[(linkedin)app\]/i],[I,[M,j]],[/(zalo(?:app)?)[\/\sa-z]*([\w\.-]+)/i],[[I,/(.+)/,"Zalo"],A,[M,j]],[/(chromium)[\/ ]([-\w\.]+)/i],[I,A],[/headlesschrome(?:\/([\w\.]+)| )/i],[A,[I,_e+" Headless"]],[/wv\).+chrome\/([\w\.]+).+edgw\//i],[A,[I,De+" WebView2"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[I,_e+" WebView"],A],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[A,[I,"Android"+Oe]],[/chrome\/([\w\.]+) mobile/i],[A,[I,He+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[I,A],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[A,[I,He+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[I,He+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[A,I],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[I,[A,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[I,A],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[I,He+Ie],A],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[I,"Netscape"],A],[/(wolvic|librewolf)\/([\w\.]+)/i],[I,A],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[A,[I,Ie+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+(?= .+rv\:.+gecko\/\d+)|[0-4][\w\.]+(?!.+compatible))/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[I,[A,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[I,[A,/[^\d\.]+./,p]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[H,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[H,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[H,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[H,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[H,"arm"]],[/ sun4\w[;\)]/i],[[H,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i,/((ppc|powerpc)(64)?)( mac|;|\))/i,/(?:osf1|[freopnt]{3,4}bsd) (alpha)/i],[[H,/ower/,p,je]],[/mc680.0/i],[[H,"68k"]],[/winnt.+\[axp/i],[[H,"alpha"]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[z,[C,ve],[M,q]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr]|browser)[-\w]+)/i,/sec-(sgh\w+)/i],[z,[C,ve],[M,N]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)[\/\);]/i],[z,[C,re],[M,N]],[/\b(?:ios|apple\w+)\/.+[\(\/](ipad)/i,/\b(ipad)[\d,]*[;\] ].+(mac |i(pad)?)os/i],[z,[C,re],[M,q]],[/(macintosh);/i],[z,[C,re]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[z,[C,Se],[M,N]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[z,[C,de],[M,q]],[/honor([-\w ]+)[;\)]/i],[z,[C,de],[M,N]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[z,[C,le],[M,q]],[/(?:huawei) ?([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][\dc][adnt]?)\b(?!.+d\/s)/i],[z,[C,le],[M,N]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b(?:xiao)?((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[z,/_/g," "],[C,ke],[M,q]],[/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/oid[^\)]+; (redmi[\-_ ]?(?:note|k)?[\w_ ]+|m?[12]\d[01]\d\w{3,6}|poco[\w ]+|(shark )?\w{3}-[ah]0|qin ?[1-3](s\+|ultra| pro)?)( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note|max|cc)?[_ ]?(?:\d{0,2}\w?)[_ ]?(?:plus|se|lite|pro)?( 5g|lte)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[z,/_/g," "],[C,ke],[M,N]],[/droid.+; (cph2[3-6]\d[13579]|((gm|hd)19|(ac|be|in|kb)20|(d[en]|eb|le|mt)21|ne22)[0-2]\d|p[g-k]\w[1m]10)\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[z,[C,pe],[M,N]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[z,[C,fe],[M,N]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[z,[C,Qe,{OnePlus:["203","304","403","404","413","415"],"*":fe}],[M,q]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[z,[C,"BLU"],[M,N]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[z,[C,"Vivo"],[M,N]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[z,[C,"Realme"],[M,N]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[z,[C,ue],[M,q]],[/lenovo[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i],[z,[C,ue],[M,N]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ]([\w\s]+)(\)| bui)/i,/((?:moto(?! 360)[-\w\(\) ]+|xt\d{3,4}[cgkosw\+]?[-\d]*|nexus 6)(?= bui|\)))/i],[z,[C,be],[M,N]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[z,[C,be],[M,q]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[z,[C,ge],[M,q]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch|webos))(\w+)/i,/\blg-?([\d\w]+) bui/i],[z,[C,ge],[M,N]],[/(nokia) (t[12][01])/i],[C,z,[M,q]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*?))( bui|\)|;|\/)/i],[[z,/_/g," "],[M,N],[C,"Nokia"]],[/(pixel (c|tablet))\b/i],[z,[C,ce],[M,q]],[/droid.+;(?: google)? (g(01[13]a|020[aem]|025[jn]|1b60|1f8f|2ybb|4s1m|576d|5nz6|8hhn|8vou|a02099|c15s|d1yq|e2ae|ec77|gh2x|kv4x|p4bc|pj41|r83y|tt9q|ur25|wvk6)|pixel[\d ]*a?( pro)?( xl)?( fold)?( \(5g\))?)( bui|\))/i],[z,[C,ce],[M,N]],[/(google) (pixelbook( go)?)/i],[C,z],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-\w\w\d\d)(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[z,[C,ye],[M,N]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[z,"Xperia Tablet"],[C,ye],[M,q]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[z,[C,ae],[M,q]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[z,/(.+)/g,"Fire Phone $1"],[C,ae],[M,N]],[/(playbook);[-\w\),; ]+(rim)/i],[z,C,[M,q]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/(?:blackberry|\(bb10;) (\w+)/i],[z,[C,he],[M,N]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[z,[C,oe],[M,q]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[z,[C,oe],[M,N]],[/(nexus 9)/i],[z,[C,"HTC"],[M,q]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[C,[z,/_/g," "],[M,N]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[z,[C,"TCL"],[M,q]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[z,[C,"TCL"],[M,N]],[/(itel) ((\w+))/i],[[C,je],z,[M,Qe,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[z,[C,"Acer"],[M,q]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[z,[C,"Meizu"],[M,N]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[z,[C,"Ulefone"],[M,N]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[z,[C,"Energizer"],[M,N]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[z,[C,"Cat"],[M,N]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[z,[C,"Smartfren"],[M,N]],[/droid.+; (a(in)?(0(15|59|6[35])|142)p?)/i],[z,[C,"Nothing"],[M,N]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[z,[C,"Archos"],[M,q]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[z,[C,"Archos"],[M,N]],[/; (n159v)/i],[z,[C,"HMD"],[M,N]],[/(imo) (tab \w+)/i,/(infinix|tecno) (x1101b?|p904|dp(7c|8d|10a)( pro)?|p70[1-3]a?|p904|t1101)/i],[C,z,[M,q]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|infinix|lava|oneplus|tcl|wiko)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(oppo) ?([\w ]+) bui/i,/(hisense) ([ehv][\w ]+)\)/i,/droid[^;]+; (philips)[_ ]([sv-x][\d]{3,4}[xz]?)/i],[C,z,[M,N]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[C,z,[M,q]],[/(surface duo)/i],[z,[C,we],[M,q]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[z,[C,"Fairphone"],[M,N]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[z,[C,me],[M,q]],[/(sprint) (\w+)/i],[C,z,[M,N]],[/(kin\.[onetw]{3})/i],[[z,/\./g," "],[C,we],[M,N]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[z,[C,xe],[M,q]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[z,[C,xe],[M,N]],[/(philips)[\w ]+tv/i,/smart-tv.+(samsung)/i],[C,[M,U]],[/hbbtv.+maple;(\d+)/i],[[z,/^/,"SmartTV"],[C,ve],[M,U]],[/(vizio)(?: |.+model\/)(\w+-\w+)/i,/tcast.+(lg)e?. ([-\w]+)/i],[C,z,[M,U]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[C,ge],[M,U]],[/(apple) ?tv/i],[C,[z,re+" TV"],[M,U]],[/crkey.*devicetype\/chromecast/i],[[z,Pe+" Third Generation"],[C,ce],[M,U]],[/crkey.*devicetype\/([^/]*)/i],[[z,/^/,"Chromecast "],[C,ce],[M,U]],[/fuchsia.*crkey/i],[[z,Pe+" Nest Hub"],[C,ce],[M,U]],[/crkey/i],[[z,Pe],[C,ce],[M,U]],[/(portaltv)/i],[z,[C,Ce],[M,U]],[/droid.+aft(\w+)( bui|\))/i],[z,[C,ae],[M,U]],[/(shield \w+ tv)/i],[z,[C,me],[M,U]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[z,[C,Se],[M,U]],[/(bravia[\w ]+)( bui|\))/i],[z,[C,ye],[M,U]],[/(mi(tv|box)-?\w+) bui/i],[z,[C,ke],[M,U]],[/Hbbtv.*(technisat) (.*);/i],[C,z,[M,U]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[C,/.+\/(\w+)/,"$1",Qe,{LG:"lge"}],[z,Ge],[M,U]],[/(playstation \w+)/i],[z,[C,ye],[M,E]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[z,[C,we],[M,E]],[/(ouya)/i,/(nintendo) (\w+)/i,/(retroid) (pocket ([^\)]+))/i,/(valve).+(steam deck)/i,/droid.+; ((shield|rgcube|gr0006))( bui|\))/i],[[C,Qe,{Nvidia:"Shield",Anbernic:"RGCUBE",Logitech:"GR0006"}],z,[M,E]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[z,[C,ve],[M,R]],[/((pebble))app/i,/(asus|google|lg|oppo|xiaomi) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[C,z,[M,R]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[z,[C,fe],[M,R]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[z,[C,re],[M,R]],[/(opwwe\d{3})/i],[z,[C,pe],[M,R]],[/(moto 360)/i],[z,[C,be],[M,R]],[/(smartwatch 3)/i],[z,[C,ye],[M,R]],[/(g watch r)/i],[z,[C,ge],[M,R]],[/droid.+; (wt63?0{2,3})\)/i],[z,[C,xe],[M,R]],[/droid.+; (glass) \d/i],[z,[C,ce],[M,L]],[/(pico) ([\w ]+) os\d/i],[C,z,[M,L]],[/(quest( \d| pro)?s?).+vr/i],[z,[C,Ce],[M,L]],[/mobile vr; rv.+firefox/i],[[M,L]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[C,[M,V]],[/(aeobc)\b/i],[z,[C,ae],[M,V]],[/(homepod).+mac os/i],[z,[C,re],[M,V]],[/windows iot/i],[[M,V]],[/droid.+; ([\w- ]+) (4k|android|smart|google)[- ]?tv/i],[z,[M,U]],[/\b((4k|android|smart|opera)[- ]?tv|tv; rv:|large screen[\w ]+safari)\b/i],[[M,U]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew|; hmsc).+?(mobile|vr|\d) safari/i],[z,[M,Qe,{mobile:"Mobile",xr:"VR","*":q}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[M,q]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[M,N]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[z,[C,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[A,[I,De+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[I,A],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[A,[I,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[I,A],[/ladybird\//i],[[I,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[A,I]],os:[[/(windows nt) (6\.[23]); arm/i],[[I,/N/,"R"],[A,Qe,Xe]],[/(windows (?:phone|mobile|iot))(?: os)?[\/ ]?([\d\.]*( se)?)/i,/(windows)[\/ ](1[01]|2000|3\.1|7|8(\.1)?|9[58]|me|server 20\d\d( r2)?|vista|xp)/i],[I,A],[/windows nt ?([\d\.\)]*)(?!.+xbox)/i,/\bwin(?=3| ?9|n)(?:nt| 9x )?([\d\.;]*)/i],[[A,/(;|\))/g,"",Qe,Xe],[I,ze]],[/(windows ce)\/?([\d\.]*)/i],[I,A],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv|ios(?=.+ip(?:ad|hone)|.+apple ?tv)|ip(?:ad|hone)(?: |.+i(?:pad)?)os|apple ?tv.+ios)[\/ ]([\w\.]+)/i,/\btvos ?([\w\.]+)/i,/cfnetwork\/.+darwin/i],[[A,/_/g,"."],[I,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+(haiku|morphos))/i],[[I,"macOS"],[A,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[A,[I,Pe+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[A,[I,Pe+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[A,[I,Pe+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[A,[I,Pe+" Linux"]],[/crkey\/([\d\.]+)/i],[A,[I,Pe]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[A,I],[/(ubuntu) ([\w\.]+) like android/i],[[I,/(.+)/,"$1 Touch"],A],[/(harmonyos)[\/ ]?([\d\.]*)/i,/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen)\w*[-\/\.; ]?([\d\.]*)/i],[I,A],[/\(bb(10);/i],[A,[I,he]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[A,[I,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[A,[I,Ie+" OS"]],[/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i,/webos(?:[ \/]?|\.tv-20(?=2[2-9]))(\d[\d\.]*)/i],[A,[I,"webOS"]],[/web0s;.+?(?:chr[o0]me|safari)\/(\d+)/i],[[A,Qe,{25:"120",24:"108",23:"94",22:"87",6:"79",5:"68",4:"53",3:"38",2:"538",1:"537","*":"TV"}],[I,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[A,[I,"watchOS"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[I,"Chrome OS"],A],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/linux.+(mint)[\/\(\) ]?([\w\.]*)/i,/(mageia|vectorlinux|fuchsia|arcaos|arch(?= ?linux))[;l ]([\d\.]*)/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire|knoppix)(?: gnu[\/ ]linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/\b(aix)[; ]([1-9\.]{0,4})/i,/(hurd|linux|morphos)(?: (?:arm|x86|ppc)\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) ?(r\d)?/i],[I,A],[/(sunos) ?([\d\.]*)/i],[[I,"Solaris"],A],[/\b(beos|os\/2|amigaos|openvms|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[I,A]]},et=(Fe.call((b={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}}).init,[[k,[I,A,O,M]],[x,[H]],[_,[M,z,C]],[T,[I,A]],[P,[I,A]]]),Fe.call(b.isIgnore,[[k,[A,O]],[T,[A]],[P,[A]]]),Fe.call(b.isIgnoreRgx,[[k,/ ?browser$/i],[P,/ ?os$/i]]),Fe.call(b.toString,[[k,[I,A]],[x,[H]],[_,[C,z]],[T,[I,A]],[P,[I,A]]]),b),tt=function(e,t){var i=et.init[t],s=et.isIgnore[t]||0,n=et.isIgnoreRgx[t]||0,a=et.toString[t]||0;function r(){Fe.call(this,i)}return r.prototype.getItem=function(){return e},r.prototype.withClientHints=function(){return Ne?Ne.getHighEntropyValues(ne).then(function(t){return e.setCH(new it(t,!1)).parseCH().get()}):e.parseCH().get()},r.prototype.withFeatureCheck=function(){return e.detectFeature().get()},t!=D&&(r.prototype.is=function(e){var t=!1;for(var i in this)if(this.hasOwnProperty(i)&&!Ue(s,i)&&je(n?We(n,this[i]):this[i])==je(n?We(n,e):e)){if(t=!0,e!=y)break}else if(e==y&&t){t=!t;break}return t},r.prototype.toString=function(){var e=p;for(var t in a)typeof this[a[t]]!==y&&(e+=(e?" ":p)+this[a[t]]);return e||y}),r.prototype.then=function(e){var t=this,i=function(){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])};i.prototype={is:r.prototype.is,toString:r.prototype.toString,withClientHints:r.prototype.withClientHints,withFeatureCheck:r.prototype.withFeatureCheck};var s=new i;return e(s),s},new r};function it(e,t){if(e=e||{},Fe.call(this,ne),t)Fe.call(this,[[B,Ve(e[Q])],[W,Ve(e[X])],[N,/\?1/.test(e[ee])],[z,$e(e[te])],[$,$e(e[ie])],[G,$e(e[se])],[H,$e(e[Y])],[F,Ve(e[K])],[J,$e(e[Z])]]);else for(var i in e)this.hasOwnProperty(i)&&typeof e[i]!==y&&(this[i]=e[i])}function st(e,t,i,s){return Fe.call(this,[["itemType",e],["ua",t],["uaCH",s],["rgxMap",i],["data",tt(this,e)]]),this}function nt(e,t,i){if(typeof e===v?(Re(e,!0)?(typeof t===v&&(i=t),t=e):(i=e,t=void 0),e=void 0):typeof e!==S||Re(t,!0)||(i=t,t=void 0),i)if(typeof i.append===f){var s={};i.forEach(function(e,t){s[String(t).toLowerCase()]=e}),i=s}else{var n={};for(var a in i)i.hasOwnProperty(a)&&(n[String(a).toLowerCase()]=i[a]);i=n}if(!(this instanceof nt))return new nt(e,t,i).getResult();var r=typeof e===S?e:i&&i[m]?i[m]:Ee&&Ee.userAgent?Ee.userAgent:p,o=new it(i,!0),h=t?function(e,t){var i={},s=t;if(!Re(t))for(var n in s={},t)for(var a in t[n])s[a]=t[n][a].concat(s[a]?s[a]:[]);for(var r in e)i[r]=s[r]&&s[r].length%2==0?s[r].concat(e[r]):e[r];return i}(Ke,t):Ke,c=function(e){return e==D?function(){return new st(e,r,h,o).set("ua",r).set(k,this.getBrowser()).set(x,this.getCPU()).set(_,this.getDevice()).set(T,this.getEngine()).set(P,this.getOS()).get()}:function(){return new st(e,r,h[e],o).parseUA().get()}};return Fe.call(this,[["getBrowser",c(k)],["getCPU",c(x)],["getDevice",c(_)],["getEngine",c(T)],["getOS",c(P)],["getResult",c(D)],["getUA",function(){return r}],["setUA",function(e){return Le(e)&&(r=Ge(e,500)),this}]]).setUA(r),this}st.prototype.get=function(e){return e?this.data.hasOwnProperty(e)?this.data[e]:void 0:this.data},st.prototype.set=function(e,t){return this.data[e]=t,this},st.prototype.setCH=function(e){return this.uaCH=e,this},st.prototype.detectFeature=function(){if(Ee&&Ee.userAgent==this.ua)switch(this.itemType){case k:Ee.brave&&typeof Ee.brave.isBrave==f&&this.set(I,"Brave");break;case _:!this.get(M)&&Ne&&Ne[N]&&this.set(M,N),"Macintosh"==this.get(z)&&Ee&&typeof Ee.standalone!==y&&Ee.maxTouchPoints&&Ee.maxTouchPoints>2&&this.set(z,"iPad").set(M,q);break;case P:!this.get(I)&&Ne&&Ne[$]&&this.set(I,Ne[$]);break;case D:var e=this.data,t=function(t){return e[t].getItem().detectFeature().get()};this.set(k,t(k)).set(x,t(x)).set(_,t(_)).set(T,t(T)).set(P,t(P))}return this},st.prototype.parseUA=function(){switch(this.itemType!=D&&Je.call(this.data,this.ua,this.rgxMap),this.itemType){case k:this.set(O,Be(this.get(A)));break;case P:if("iOS"==this.get(I)&&"18.6"==this.get(A)){var e=/\) Version\/([\d\.]+)/.exec(this.ua);e&&parseInt(e[1].substring(0,2),10)>=26&&this.set(A,e[1])}}return this},st.prototype.parseCH=function(){var e=this.uaCH,t=this.rgxMap;switch(this.itemType){case k:case T:var i,s=e[W]||e[B];if(s)for(var n=0;n<s.length;n++){var a=s[n].brand||s[n],r=s[n].version;this.itemType==k&&!/not.a.brand/i.test(a)&&(!i||/Chrom/.test(i)&&a!=Te||i==De&&/WebView2/.test(a))&&(a=Qe(a,Ze),(i=this.get(I))&&!/Chrom/.test(i)&&/Chrom/.test(a)||this.set(I,a).set(A,r).set(O,Be(r)),i=a),this.itemType==T&&a==Te&&this.set(A,r)}break;case x:var o=e[H];o&&(o&&"64"==e[J]&&(o+="64"),Je.call(this.data,o+";",t));break;case _:if(e[N]&&this.set(M,N),e[z]&&(this.set(z,e[z]),!this.get(M)||!this.get(C))){var h={};Je.call(h,"droid 9; "+e[z]+")",t),!this.get(M)&&h.type&&this.set(M,h.type),!this.get(C)&&h.vendor&&this.set(C,h.vendor)}if(e[F]){var c;if("string"!=typeof e[F])for(var l=0;!c&&l<e[F].length;)c=Qe(e[F][l++],Ye);else c=Qe(e[F],Ye);this.set(M,c)}break;case P:var u=e[$];if(u){var d=e[G];u==ze&&(d=parseInt(Be(d),10)>=13?"11":"10"),this.set(I,u).set(A,d)}this.get(I)==ze&&"Xbox"==e[z]&&this.set(I,"Xbox").set(A,void 0);break;case D:var g=this.data,w=function(t){return g[t].getItem().setCH(e).parseCH().get()};this.set(k,w(k)).set(x,w(x)).set(_,w(_)).set(T,w(T)).set(P,w(P))}return this},nt.VERSION="2.0.7",nt.BROWSER=qe([I,A,O,M]),nt.CPU=qe([H]),nt.DEVICE=qe([z,C,M,E,N,U,q,R,V]),nt.ENGINE=nt.OS=qe([I,A]);class at{constructor(){this.parser=new nt}async detectWithClientHints(){try{const e=await this.parser.withClientHints();return this.mapResult(e)}catch{return this.detect()}}detect(){const e=this.parser.getResult();return this.mapResult(e)}mapResult(e){return{screen_width:window.screen.width,screen_height:window.screen.height,viewport_width:window.innerWidth,viewport_height:window.innerHeight,device:this.normalizeDeviceType(e.device.type),browser:e.browser.name||"Unknown",browser_type:this.getBrowserType(e),os:this.normalizeOS(e.os.name,e.device.type),user_agent:navigator.userAgent,connection_type:this.getConnectionType(),timezone:this.getTimezone(),language:navigator.language||"en"}}normalizeDeviceType(e){switch(e){case"mobile":return"mobile";case"tablet":return"tablet";default:return"desktop"}}normalizeOS(e,t){if(!e)return"Unknown";if("iOS"===e&&"tablet"===t)return"iPadOS";return{"Mac OS":"macOS",Windows:"Windows",iOS:"iOS",Android:"Android",Linux:"Linux","Chrome OS":"Chrome OS",Ubuntu:"Linux",Fedora:"Linux",Debian:"Linux"}[e]||e}getBrowserType(e){const t=navigator.userAgent.toLowerCase();return/bot|crawler|spider|scraper/i.test(t)?"crawler":/fbav|fban|instagram|twitter|linkedin|pinterest/i.test(t)?"inapp":/thunderbird|outlook/i.test(t)?"email":/headless|phantom|puppeteer|selenium/i.test(t)?"fetcher":/curl|wget|httpie/i.test(t)?"cli":null}getConnectionType(){const e=navigator.connection;return e?.effectiveType||""}getTimezone(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return""}}}class rt{constructor(){this.maxScrollPercent=0,this.onMilestone=null,this.lastMilestone=0,this.boundHandler=null,this.boundHandler=function(e,t){let i=0,s=null;return(...n)=>{const a=Date.now(),r=a-i;r>=t?(i=a,e(...n)):(s&&clearTimeout(s),s=setTimeout(()=>{i=Date.now(),e(...n),s=null},t-r))}}(()=>this.handleScroll(),100)}start(){this.boundHandler&&window.addEventListener("scroll",this.boundHandler,{passive:!0}),this.handleScroll()}stop(){this.boundHandler&&window.removeEventListener("scroll",this.boundHandler)}setMilestoneCallback(e){this.onMilestone=e}getMaxScrollPercent(){return this.maxScrollPercent}handleScroll(){const e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),t=window.innerHeight,i=window.pageYOffset||document.documentElement.scrollTop,s=e-t;if(s<=0)return void(this.maxScrollPercent=100);const n=Math.round(i/s*100),a=Math.min(100,Math.max(0,n));a>this.maxScrollPercent&&(this.maxScrollPercent=a,this.checkMilestones(a))}checkMilestones(e){if(!this.onMilestone)return;const t=[25,50,75,100];for(const i of t)e>=i&&this.lastMilestone<i&&(this.lastMilestone=i,this.onMilestone(i))}reset(){this.maxScrollPercent=0,this.lastMilestone=0}}class ot{constructor(){this.onNavigate=null,this.originalPushState=null,this.originalReplaceState=null,this.handleNavigation=()=>{const e=window.location.href;e!==this.currentUrl&&(this.currentUrl=e,this.onNavigate&&this.onNavigate(e))},this.currentUrl=window.location.href}start(){this.patchHistory(),window.addEventListener("popstate",this.handleNavigation),window.addEventListener("hashchange",this.handleNavigation)}stop(){this.restoreHistory(),window.removeEventListener("popstate",this.handleNavigation),window.removeEventListener("hashchange",this.handleNavigation)}setNavigationCallback(e){this.onNavigate=e}patchHistory(){this.originalPushState=history.pushState,this.originalReplaceState=history.replaceState,history.pushState=(...e)=>{this.originalPushState?.apply(history,e),this.handleNavigation()},history.replaceState=(...e)=>{this.originalReplaceState?.apply(history,e),this.handleNavigation()}}restoreHistory(){this.originalPushState&&(history.pushState=this.originalPushState),this.originalReplaceState&&(history.replaceState=this.originalReplaceState)}getCurrentUrl(){return this.currentUrl}}const ht=[/bot/i,/crawler/i,/spider/i,/scraper/i,/googlebot/i,/bingbot/i,/yandex/i,/baidu/i,/duckduck/i,/slurp/i,/msnbot/i,/ia_archiver/i,/facebook/i,/twitter/i,/linkedin/i,/pinterest/i,/headless/i,/phantom/i,/selenium/i,/puppeteer/i,/lighthouse/i,/pagespeed/i,/gtmetrix/i];const ct=[{after:0,desktopInterval:1e4,mobileInterval:7e3},{after:18e4,desktopInterval:2e4,mobileInterval:14e3},{after:3e5,desktopInterval:3e4,mobileInterval:21e3}],lt={debug:!1,sessionTimeout:18e5,heartbeatInterval:1e4,adClickIds:l,trackSPA:!0,trackScroll:!0,trackClicks:!1,heartbeatTiers:ct,heartbeatMaxDuration:6e5,resetHeartbeatOnNavigation:!1};const ut=new class{constructor(){this.config=null,this.storage=null,this.tabStorage=null,this.sessionManager=null,this.sessionState=null,this.sender=null,this.deviceDetector=null,this.scrollTracker=null,this.navigationTracker=null,this.deviceInfo=null,this.heartbeatTimeout=null,this.sendDebounceTimeout=null,this.heartbeatState={activeStartTime:0,accumulatedActiveMs:0,isActive:!1,maxDurationReached:!1,lastPingTime:0,currentTierIndex:0,pageActiveMs:0,pageStartTime:0},this.isMobileDevice=!1,this.isTracking=!1,this.isPaused=!1,this.isInitialized=!1,this.initPromise=null,this.flushed=!1,this.onVisibilityChange=()=>{"hidden"===document.visibilityState?(this.stopHeartbeat(!0),this.flushOnce()):"visible"===document.visibilityState&&(this.flushed=!1,this.isPaused||this.heartbeatState.maxDurationReached||this.resumeHeartbeat())},this.onFocus=()=>{this.flushed=!1,this.isPaused||this.heartbeatState.maxDurationReached||this.resumeHeartbeat()},this.onBlur=()=>{this.stopHeartbeat(!0),this.flushOnce()},this.onFreeze=()=>{this.stopHeartbeat(!0),this.flushOnce()},this.onResume=()=>{this.flushed=!1,this.isPaused||this.heartbeatState.maxDurationReached||this.resumeHeartbeat()},this.onUnload=()=>{this.flushOnce()},this.onPageShow=e=>{e.persisted&&(this.flushed=!1,this.isPaused||this.heartbeatState.maxDurationReached||this.resumeHeartbeat(),this.sessionState?.restore(),this.config)}}init(e){return this.isInitialized?Promise.resolve():(this.initPromise||(this.initPromise=this.initializeAsync(e)),this.initPromise)}async initializeAsync(e){if(!e.workspace_id)throw new Error("workspace_id is required");if(!e.endpoint)throw new Error("endpoint is required");if(function(){const e=navigator.userAgent.toLowerCase();return!!ht.some(t=>t.test(e))||(!!navigator.webdriver||[!("plugins"in navigator)||0===navigator.plugins.length,!("languages"in navigator)||0===navigator.languages.length,!window.chrome&&/chrome/i.test(e),0===screen.width||0===screen.height,!("ontouchstart"in window)&&/mobile/i.test(e)].filter(Boolean).length>=3)}())return;this.config={...lt,...e},this.config.heartbeatTiers=this.validateTiers(this.config.heartbeatTiers),0!==this.config.heartbeatMaxDuration&&this.config.heartbeatMaxDuration<6e4&&(this.config.heartbeatMaxDuration=6e4),this.storage=new t,this.tabStorage=new i,this.deviceDetector=new at,this.deviceInfo=await this.deviceDetector.detectWithClientHints(),this.isMobileDevice="desktop"!==this.deviceInfo?.device,this.sessionManager=new u(this.storage,this.tabStorage,this.config);const s=this.sessionManager.getOrCreateSession();this.sender=new w(this.config.endpoint,this.storage,this.config.debug),this.config.trackScroll&&(this.scrollTracker=new rt,this.scrollTracker.start()),this.config.trackSPA&&(this.navigationTracker=new ot,this.navigationTracker.setNavigationCallback(e=>this.onNavigation(e)),this.navigationTracker.start());const n={workspace_id:this.config.workspace_id,session_id:s.id,created_at:s.created_at};this.sessionState=new g(n),this.sessionState.restore(),this.sessionState.addPageview(window.location.pathname),this.bindEvents(),this.isTracking=!0,this.isInitialized=!0;const a=Date.now();this.heartbeatState.pageStartTime=a,this.heartbeatState.activeStartTime=a,this.startHeartbeat(),await this.sendPayload(),this.config.debug}bindEvents(){document.addEventListener("visibilitychange",this.onVisibilityChange),window.addEventListener("focus",this.onFocus),window.addEventListener("blur",this.onBlur),document.addEventListener("freeze",this.onFreeze),document.addEventListener("resume",this.onResume),window.addEventListener("pagehide",this.onUnload),window.addEventListener("beforeunload",this.onUnload),window.addEventListener("pageshow",this.onPageShow)}flushOnce(){if(this.flushed)return;if(this.flushed=!0,!this.sessionState||!this.sender)return;this.scrollTracker&&this.sessionState.updateScroll(this.scrollTracker.getMaxScrollPercent()),this.sessionState.finalizeForUnload();const e=this.buildAttributes(),t=this.sessionState.buildPayload(e);this.sender.sendSessionBeacon(t),this.sessionState.persist()}onNavigation(e){this.sessionState&&(this.config,this.scrollTracker&&this.sessionState.updateScroll(this.scrollTracker.getMaxScrollPercent()),this.sessionState.addPageview(window.location.pathname),this.scrollTracker?.reset(),this.resetPageActiveTime(),this.config?.resetHeartbeatOnNavigation&&(this.resetHeartbeatState(),this.startHeartbeat()),this.scheduleDebouncedSend(),this.sessionState.persist())}startHeartbeat(){if(!this.config)return;if(this.heartbeatState.maxDurationReached)return void this.config.debug;this.stopHeartbeat(!1);const e=Date.now();this.heartbeatState.activeStartTime=e,this.heartbeatState.isActive=!0,this.heartbeatState.lastPingTime=e,this.scheduleNextHeartbeat()}resumeHeartbeat(){if(!this.config)return;if(this.heartbeatState.maxDurationReached)return;const e=Date.now();this.heartbeatState.activeStartTime=e,this.heartbeatState.pageStartTime=e,this.heartbeatState.isActive=!0,this.heartbeatState.lastPingTime=e,this.scheduleNextHeartbeat()}scheduleNextHeartbeat(){if(!this.config||!this.heartbeatState.isActive)return;if(this.checkAndUpdateMaxDuration())return void this.stopHeartbeat(!0);const e=this.getCurrentInterval();if(null===e)return this.heartbeatState.maxDurationReached=!0,this.stopHeartbeat(!0),void this.config.debug;const t=this.heartbeatState.lastPingTime+e,i=Date.now(),s=Math.max(0,t-i);this.heartbeatTimeout=setTimeout(()=>{if(this.shouldSendPing()){const e=Date.now();e-t>1e3&&this.config;const i=this.getCurrentTier();i&&(this.heartbeatState.currentTierIndex=i.index),this.sendPingEvent(),this.heartbeatState.lastPingTime=e,this.scheduleNextHeartbeat()}},s)}shouldSendPing(){return!this.isPaused&&this.isTracking&&this.heartbeatState.isActive&&!document.hidden&&"visible"===document.visibilityState}sendPingEvent(){this.sessionState&&(this.scrollTracker&&this.sessionState.updateScroll(this.scrollTracker.getMaxScrollPercent()),this.sendPayload().catch(()=>{}))}stopHeartbeat(e=!0){if(e&&this.heartbeatState.isActive){const e=Date.now(),t=e-this.heartbeatState.activeStartTime;this.heartbeatState.accumulatedActiveMs+=t;const i=e-this.heartbeatState.pageStartTime;this.heartbeatState.pageActiveMs+=i}this.heartbeatState.isActive=!1,this.heartbeatTimeout&&(clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=null)}getTotalActiveMs(){let e=this.heartbeatState.accumulatedActiveMs;return this.heartbeatState.isActive&&(e+=Date.now()-this.heartbeatState.activeStartTime),e}checkAndUpdateMaxDuration(){if(!this.config||0===this.config.heartbeatMaxDuration)return!1;if(this.getTotalActiveMs()>=this.config.heartbeatMaxDuration){if(this.heartbeatState.maxDurationReached=!0,this.config.debug){this.getCurrentTier()}return!0}return!1}getCurrentTier(){if(!this.config)return null;const e=this.getTotalActiveMs(),t=this.config.heartbeatTiers;let i=t[0],s=0;for(let n=0;n<t.length&&e>=t[n].after;n++)i=t[n],s=n;return{tier:i,index:s}}getCurrentInterval(){const e=this.getCurrentTier();if(!e)return null;const{tier:t}=e;return this.isMobileDevice?t.mobileInterval:t.desktopInterval}resetHeartbeatState(){this.stopHeartbeat(!1),this.heartbeatState={activeStartTime:0,accumulatedActiveMs:0,isActive:!1,maxDurationReached:!1,lastPingTime:0,currentTierIndex:0,pageActiveMs:0,pageStartTime:Date.now()}}resetPageActiveTime(){this.heartbeatState.pageActiveMs=0,this.heartbeatState.pageStartTime=Date.now()}validateTiers(e){if(!e||0===e.length)return ct;const t=[...e].sort((e,t)=>e.after-t.after);return 0!==t[0].after&&t.unshift({after:0,desktopInterval:1e4,mobileInterval:7e3}),t.map(e=>({...e,desktopInterval:null===e.desktopInterval?null:Math.max(e.desktopInterval,5e3),mobileInterval:null===e.mobileInterval?null:Math.max(e.mobileInterval,5e3)}))}scheduleDebouncedSend(){this.sendDebounceTimeout&&clearTimeout(this.sendDebounceTimeout),this.sendDebounceTimeout=setTimeout(async()=>{this.sendDebounceTimeout=null,await this.sendPayload()},100)}async sendPayload(){if(!this.sessionState||!this.sender)return;const e=this.buildAttributes(),t=this.sessionState.buildPayload(e),i=await this.sender.sendSession(t);i.success&&(this.sessionState.hasAttributesSent()||this.sessionState.markAttributesSent(),void 0!==i.checkpoint&&this.sessionState.applyCheckpoint(i.checkpoint),this.sessionState.persist())}buildAttributes(){const e=this.sessionManager?.getSession(),t=this.deviceInfo;return{landing_page:e?.landing_page||window.location.href,referrer:e?.referrer||void 0,utm_source:e?.utm?.source||void 0,utm_medium:e?.utm?.medium||void 0,utm_campaign:e?.utm?.campaign||void 0,utm_term:e?.utm?.term||void 0,utm_content:e?.utm?.content||void 0,utm_id:e?.utm?.id||void 0,utm_id_from:e?.utm?.id_from||void 0,screen_width:t?.screen_width,screen_height:t?.screen_height,viewport_width:t?.viewport_width,viewport_height:t?.viewport_height,device:t?.device,browser:t?.browser,browser_type:t?.browser_type||void 0,os:t?.os,user_agent:t?.user_agent,connection_type:t?.connection_type,language:t?.language,timezone:t?.timezone}}async getSessionId(){return await this.ensureInitialized(),this.sessionManager?.getSessionId()||""}async getVisitorId(){return await this.ensureInitialized(),this.sessionManager?.getVisitorId()||""}async getFocusDuration(){if(await this.ensureInitialized(),!this.sessionState)return 0;const e=this.sessionState.getActions();let t=0;for(const i of e)"pageview"===i.type&&(t+=i.duration);const i=this.sessionState.getCurrentPage();return i&&(t+=Date.now()-i.entered_at),t}async getTotalDuration(){await this.ensureInitialized();const e=this.sessionManager?.getSession();return e?Date.now()-e.created_at:0}async trackPageView(e){if(await this.ensureInitialized(),!this.sessionState)return;this.scrollTracker&&this.sessionState.updateScroll(this.scrollTracker.getMaxScrollPercent());const t=e||window.location.pathname;this.sessionState.addPageview(t),this.scrollTracker?.reset(),this.resetPageActiveTime(),this.scheduleDebouncedSend(),this.sessionState.persist()}async trackGoal(e){await this.ensureInitialized(),this.sessionState&&(this.sessionState.addGoal(e.action,e.value,e.properties),this.sendDebounceTimeout&&(clearTimeout(this.sendDebounceTimeout),this.sendDebounceTimeout=null),await this.sendPayload(),this.sessionState.persist())}async setDimension(e,t){await this.ensureInitialized(),this.sessionManager?.setDimension(e,t)}async setDimensions(e){await this.ensureInitialized(),this.sessionManager?.setDimensions(e)}async getDimension(e){return await this.ensureInitialized(),this.sessionManager?.getDimension(e)||null}async clearDimensions(){await this.ensureInitialized(),this.sessionManager?.clearDimensions()}async pause(){await this.ensureInitialized(),this.isPaused=!0,this.stopHeartbeat(!0)}async resume(){await this.ensureInitialized(),this.isPaused=!1,this.resetHeartbeatState(),this.startHeartbeat()}async reset(){if(await this.ensureInitialized(),!this.sessionManager||!this.config)return;this.sessionManager.reset();const e=this.sessionManager.getOrCreateSession(),t={workspace_id:this.config.workspace_id,session_id:e.id,created_at:e.created_at};this.sessionState=new g(t),this.sessionState.addPageview(window.location.pathname),this.scrollTracker?.reset(),this.resetHeartbeatState(),this.startHeartbeat(),await this.sendPayload()}getConfig(){return this.config?{...this.config}:null}debug(){return{session:this.sessionManager?.getSession()||null,config:this.config,isTracking:this.isTracking,actionsCount:this.sessionState?.getActions().length||0,checkpoint:this.sessionState?.getCheckpoint()||-1,currentPage:this.sessionState?.getCurrentPage()?.path||null}}async ensureInitialized(){if(!this.isInitialized){if(!this.initPromise)throw new Error("Staminads not configured. Set window.StaminadsConfig before loading the SDK.");await this.initPromise}}},dt={init:e=>ut.init(e),getSessionId:()=>ut.getSessionId(),getVisitorId:()=>ut.getVisitorId(),getConfig:()=>ut.getConfig(),getFocusDuration:()=>ut.getFocusDuration(),getTotalDuration:()=>ut.getTotalDuration(),trackPageView:e=>ut.trackPageView(e),trackGoal:e=>ut.trackGoal(e),setDimension:(e,t)=>ut.setDimension(e,t),setDimensions:e=>ut.setDimensions(e),getDimension:e=>ut.getDimension(e),clearDimensions:()=>ut.clearDimensions(),pause:()=>ut.pause(),resume:()=>ut.resume(),reset:()=>ut.reset(),debug:()=>ut.debug()};return"undefined"!=typeof window&&window.StaminadsConfig&&ut.init(window.StaminadsConfig),dt});
//# sourceMappingURL=staminads.min.js.map
